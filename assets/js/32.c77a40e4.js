(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{508:function(t,e,s){"use strict";s.r(e);var a=s(5),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("想做個自己進電影院看電影的紀錄"),e("br"),t._v("\n需要的資料格式很簡單就不想搞DB、弄後台介面"),e("br"),t._v("\n因此拿 Google 試算表當成簡易資料庫"),e("br"),t._v("\n然後取得JSON格式的資料變成API來做應用")]),t._v(" "),e("h2",{attrs:{id:"google-sheets-as-a-json-endpoint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#google-sheets-as-a-json-endpoint"}},[t._v("#")]),t._v(" Google Sheets as a JSON Endpoint")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("檔案 > 發佈到網路"),e("br"),t._v("\n要發布範圍跟類型就直接選"),e("code",[t._v("整份文件")]),t._v("、"),e("code",[t._v("網頁")]),t._v("就好了"),e("br"),t._v("\n點發佈後就能夠獲得文件的公開連結"),e("br"),t._v(" "),e("img",{staticClass:"w-64 my-2",attrs:{src:"https://i.imgur.com/Pm03es5.png","data-action":"zoom"}}),e("br"),t._v("\n另外要點右上角的"),e("code",[t._v("共用")]),e("br"),t._v(" "),e("img",{attrs:{src:"https://i.imgur.com/E6yOfKa.png",alt:""}}),e("br"),t._v("\n調整為知道連結的使用者都可以查看")])]),t._v(" "),e("li",[e("p",[t._v("透過文件的公開連結取得 Sheets 的 Key")]),t._v(" "),e("p",[e("span",{staticClass:"text-blue-500 dark:text-blue-200"},[t._v("ht"),e("span",[t._v("t")]),t._v("ps://docs.google.com/spreadsheets/d/e/"),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ key }")]),t._v("/pubhtml")])])]),t._v(" "),e("li",[e("p",[t._v("取得 JSON 格式資料"),e("br"),t._v("\n然後將 key 替換到下面這個格式的網址"),e("br"),t._v("\nindex 則是代表工作表的順序，需要取得第一張工作表的資料就填入1即可")]),t._v(" "),e("p",[e("span",{staticClass:"text-blue-500 dark:text-blue-200"},[t._v("ht"),e("span",[t._v("t")]),t._v("ps://spreadsheets.google.com/feeds/list/"),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ key }")]),t._v("/"),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ index }")]),t._v("/public/values?alt=json")])]),t._v(" "),e("p",[t._v("回傳的資料格式如下，長的比較特別，就要再另外自己整理了"),e("br"),t._v(" "),e("img",{staticClass:"w-64 my-2",attrs:{src:"https://i.imgur.com/joA9hCP.png","data-action":"zoom"}})])])]),t._v(" "),e("h2",{attrs:{id:"google-sheets-api-v4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#google-sheets-api-v4"}},[t._v("#")]),t._v(" Google Sheets API v4")]),t._v(" "),e("p",[t._v("前陣子發現我的電影紀錄偶爾會拿不到資料"),e("br"),t._v("\n甚至有一整天就直接掛掉"),e("br"),t._v("\n搜尋了一下找到"),e("a",{attrs:{href:"https://support.google.com/docs/thread/121088347/retrieving-data-from-sheets-results-in-404-error-50-of-the-time?hl=en&msgid=121557699",target:"_blank",rel:"noopener noreferrer"}},[t._v("這篇"),e("OutboundLink")],1),t._v("建議升級使用 v4")]),t._v(" "),e("p",[t._v("只需要將網址替換為下面這個格式"),e("br"),t._v(" "),e("span",{staticClass:"text-blue-500 dark:text-blue-200"},[t._v("ht"),e("span",[t._v("t")]),t._v("ps://sheets.googleapis.com/v4/spreadsheets/"),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ key }")]),t._v("/values/"),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ 工作表名稱與範圍 }")]),t._v("?key="),e("span",{staticClass:"text-red-400 text-xl"},[t._v("{ API Key }")])])]),t._v(" "),e("ul",[e("li",[t._v("key: 取得的方式與之前相同，也一樣需要將試算表設定為任何擁有連結的人都查看")]),t._v(" "),e("li",[t._v("工作表名稱與範圍: "),e("code",[t._v("工作表名稱")]),t._v("就真的是"),e("code",[t._v("名稱")]),t._v("\b，如果是中文最好用"),e("code",[t._v("encodeURIComponent")]),t._v("編碼過；如果想要加上指定範圍的話則像是: "),e("code",[t._v("工作表1!A:D")]),t._v(" 這樣指定只取得 A ~ D 的資料")]),t._v(" "),e("li",[t._v("API key: 就到 "),e("a",{attrs:{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer"}},[t._v("console"),e("OutboundLink")],1),t._v(" 去啟用 "),e("code",[t._v("Google Sheets API")]),t._v(" 然後申請一組"),e("code",[t._v("API金鑰")]),e("br"),t._v(" "),e("span",{staticClass:"text-xs"},[t._v("有要修改的話才需要OAuth用戶端ID，僅查看的話申請API金鑰即可")])])]),t._v(" "),e("p",[t._v("回傳的格式如下，比起之前更簡單易用了"),e("br"),t._v(" "),e("img",{attrs:{src:"https://i.imgur.com/FmN9yzs.png",alt:""}})]),t._v(" "),e("h4",{attrs:{id:"應用😎"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#應用😎"}},[t._v("#")]),t._v(" 應用😎")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://clipwww.github.io/log/#/movie",target:"_blank",rel:"noopener noreferrer"}},[t._v("我的看電影紀錄"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);