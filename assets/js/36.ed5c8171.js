(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{511:function(t,e,r){"use strict";r.r(e);var n=r(5),s=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[e("RouterLink",{attrs:{to:"/_posts/2021/2021-09-23-Intersection-observer.html"}},[t._v("Intersection Observer 筆記")])],1),t._v(" "),e("h2",{attrs:{id:"遇到的問題與原因"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#遇到的問題與原因"}},[t._v("#")]),t._v(" 遇到的問題與原因")]),t._v(" "),e("p",[t._v("使用 Intersection Observer 來實現滾動到對應數字時選擇該數字"),e("br"),t._v(" "),e("img",{attrs:{src:"https://i.imgur.com/V9bH6Pb.png",alt:""}}),e("br"),t._v("\n一開始用 padding 來調整 root element 的可視範圍在 Edge 上一切正常")]),t._v(" "),e("p",[t._v("然而當使用 Firefox 進行測試時卻遇到異常"),e("br"),t._v("\n檢查後發現在 Firefox 時回傳的 entries 會有 1 個以上 isIntersecting 的物件"),e("br"),t._v("\nFirefox 的觀察範圍比其他瀏覽器都還要大")]),t._v(" "),e("p",[t._v("搜尋了相關 Issue 後找到這篇")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://stackoverflow.com/questions/71283704/intersection-observer-padding-changes-boundaries-of-root-element",target:"_blank",rel:"noopener noreferrer"}},[t._v("Intersection Observer: padding changes 'boundaries' of root element?"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("做了些許測試後得出以下結論"),e("br"),t._v("\n當 IntersectionObserver 的 root 有 padding 時")]),t._v(" "),e("ul",[e("li",[t._v("Chrome/Edge/Safari: 會以 content 作為觀察範圍")]),t._v(" "),e("li",[t._v("Firefox: 會以 padding + content 作為觀察範圍")])]),t._v(" "),e("img",{staticClass:"bg-white p-2",attrs:{src:"https://i.imgur.com/C7b6aLM.png"}}),t._v(" "),e("h2",{attrs:{id:"codepen-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#codepen-example"}},[t._v("#")]),t._v(" CodePen Example")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://codepen.io/clipwww/pen/Poexxar",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://codepen.io/clipwww/pen/Poexxar"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("root box (h: 300px, padding: 100px)")]),t._v(" "),e("h3",{attrs:{id:"chrome-以-content-作為觀察範圍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chrome-以-content-作為觀察範圍"}},[t._v("#")]),t._v(" Chrome: 以 content 作為觀察範圍")]),t._v(" "),e("p",[t._v("完全進入 content 才會變綠色")]),t._v(" "),e("div",{staticClass:"flex items-center"},[e("img",{staticClass:"w-1/2",attrs:{src:"https://i.imgur.com/NlCTsVv.png"}}),t._v(" "),e("img",{staticClass:"w-1/2",attrs:{src:"https://i.imgur.com/L487l7i.png"}})]),t._v(" "),e("h3",{attrs:{id:"firefox-以-padding-content-作為觀察範圍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#firefox-以-padding-content-作為觀察範圍"}},[t._v("#")]),t._v(" Firefox: 以 padding + content 作為觀察範圍")]),t._v(" "),e("p",[t._v("還沒完全進入 content ，但已經完全進入 padding 範圍，就變綠色了"),e("br"),t._v(" "),e("img",{attrs:{src:"https://i.imgur.com/FJ7Z8se.png",alt:""}})]),t._v(" "),e("h2",{attrs:{id:"解法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解法"}},[t._v("#")]),t._v(" 解法")]),t._v(" "),e("ul",[e("li",[t._v("root element 不要有 padding 避免不同瀏覽器行為不一致")]),t._v(" "),e("li",[t._v("用 "),e("code",[t._v("rootMargin")]),t._v(" 去調整觀察範圍，需要縮小時就用"),e("strong",[t._v("負數")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);