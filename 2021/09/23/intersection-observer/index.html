<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Intersection Observer 筆記 | David&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="/blog/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/rss+xml" href="https://clipwww.github.io/blog/rss.xml" title="David&#39;s Blog RSS Feed">
    <link rel="alternate" type="application/json" href="https://clipwww.github.io/blog/feed.json" title="David&#39;s Blog JSON Feed">
    <meta name="description" content="Intersection Observer API 可觀察目標元素 (target) 與其根層 (root) 或瀏覽器 (viewport) 的交互狀態，當目標元素進入/離開設定的條件時就呼叫 callback">
    
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/css/0.styles.671c2b0a.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/app.eb5ff63d.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/9.da230e77.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/2.5ed50062.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/24.f23d7b72.js" as="script"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/1.8994a6b0.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/10.cf57f49b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/11.3951b960.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/12.de668923.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/15.fe99c714.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/16.1f7d46b8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/17.865cac9a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/18.4aad60ab.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/19.e5882508.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/20.5a1b1f84.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/21.8a64be08.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/22.984e4935.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/23.40ae8190.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/25.bf38f5ba.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/26.1214a013.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/27.e5f8b4ea.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/28.4c3ca496.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/29.fcf85ac2.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/3.221e3cbb.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/30.e11fac5c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/31.a9456ef1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/32.bf2d0a6d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/33.1f7ed15d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/34.c9a7479c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/35.73236c3c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/36.07757c3f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/37.b91c3974.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/38.153c1941.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/39.93cb2df1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/4.8d85318d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/40.20b960c5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/41.edc237bb.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/42.af12fb38.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/43.e8d9bebe.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/44.1bea38c8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/45.73d2f1c2.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/46.46d1f1d0.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/47.c912aee5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/48.c09ab230.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/49.ef45d2a1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/5.d64ef58a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/50.ad7730aa.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/51.0c1cbc58.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/52.c1623de5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/53.55d5283d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/54.9725a814.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/55.697c5c37.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/56.1fd20475.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/57.eb753fc6.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/58.8e7ac96e.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/59.0b10311b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/6.48112d9f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/7.87446e55.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/8.a41bee78.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/vuejs-paginate.f20f3465.js">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/css/0.styles.671c2b0a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">David's Blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/about/" class="nav-link">About</a></li><li class="nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="/blog/link/" class="nav-link">Link</a></li> <li class="nav-item"><!----></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a href="/blog/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">David's Blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/about/" class="nav-link">About</a></li><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="/blog/link/" class="nav-link">Link</a></li> <li class="mobile-nav-item"><!----></li> <li class="mobile-nav-item"><a href="/blog/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        Intersection Observer 筆記
      </h1> <div class="post-meta"><!----> <div class="post-meta-date flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2021-09-23T00:00:00.000Z">
      2021/09/23
    </time></div> <!----> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-314d5a9c><a href="/blog/tag/JavaScript" data-v-314d5a9c><span data-v-314d5a9c>JavaScript</span></a></li><li class="post-tag" data-v-314d5a9c><a href="/blog/tag/Intersection Observer" data-v-314d5a9c><span data-v-314d5a9c>Intersection Observer</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default" data-v-eeb3f718 data-v-eeb3f718><h2 id="intersection-observer-api" data-v-eeb3f718><a href="#intersection-observer-api" class="header-anchor" data-v-eeb3f718>#</a> Intersection Observer API</h2> <p data-v-eeb3f718>觀察目標元素 (target) 與其根層 (root) 或瀏覽器 (viewport) 的交互狀態，當目標元素進入/離開設定的條件時就呼叫 callback</p> <p data-v-eeb3f718>可以取代監聽 Scroll 事件的方式來實作：</p> <ul data-v-eeb3f718><li data-v-eeb3f718>Lazy Loading 圖片，當圖片出現在可視範圍時才開始載入</li> <li data-v-eeb3f718>Infinite Scroll 無限加載內容，當滾動到頁面底端，或者指定的底部區塊出現時自動載入更多內容</li> <li data-v-eeb3f718>Scroll Spy 滾動監控，滾動到對應的區塊時才加上 active 的樣式</li> <li data-v-eeb3f718>當元素出現在可視範圍時才展示的動畫</li></ul> <h2 id="使用" data-v-eeb3f718><a href="#使用" class="header-anchor" data-v-eeb3f718>#</a> 使用</h2> <h3 id="建立一個-observer-觀察者" data-v-eeb3f718><a href="#建立一個-observer-觀察者" class="header-anchor" data-v-eeb3f718>#</a> 建立一個 observer 觀察者</h3> <div class="language-js extra-class" data-v-eeb3f718><pre class="language-js" data-v-eeb3f718><code data-v-eeb3f718><span class="token keyword" data-v-eeb3f718>const</span> options <span class="token operator" data-v-eeb3f718>=</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  <span class="token literal-property property" data-v-eeb3f718>root</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token keyword" data-v-eeb3f718>null</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token literal-property property" data-v-eeb3f718>rootMargin</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token string" data-v-eeb3f718>'0px'</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token literal-property property" data-v-eeb3f718>threshold</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token number" data-v-eeb3f718>0</span>
<span class="token punctuation" data-v-eeb3f718>}</span>

<span class="token keyword" data-v-eeb3f718>const</span> observer <span class="token operator" data-v-eeb3f718>=</span> <span class="token keyword" data-v-eeb3f718>new</span> <span class="token class-name" data-v-eeb3f718>IntersectionObserver</span><span class="token punctuation" data-v-eeb3f718>(</span>callback<span class="token punctuation" data-v-eeb3f718>,</span> options<span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>
</code></pre></div><h4 id="options" data-v-eeb3f718><a href="#options" class="header-anchor" data-v-eeb3f718>#</a> Options</h4> <ul data-v-eeb3f718><li data-v-eeb3f718><p data-v-eeb3f718><code data-v-eeb3f718>root</code><br data-v-eeb3f718>
Element | 欲觀察的根層，default 為 null，也就是 window 層的 viewport</p></li> <li data-v-eeb3f718><p data-v-eeb3f718><code data-v-eeb3f718>rootMargin</code><br data-v-eeb3f718>
根層的範圍偏移量，default 為 &quot;0px 0px 0px 0px&quot;，寫法跟 css 的 margin 一樣</p></li> <li data-v-eeb3f718><p data-v-eeb3f718><code data-v-eeb3f718>threshold</code><br data-v-eeb3f718>
目標進入/離開觀察範圍多少比例時觸發 callback，default 為 [0]，也就是當目標一進入/離開觀察範圍就會觸發<br data-v-eeb3f718>
可以設定單一值，在到達該比例時觸發 ( 範圍: 0 ~ 1 )<br data-v-eeb3f718>
或是設定 Array ex. [0, 0.25, 0.5, 1] 每達到一次設定的值就觸發一次</p></li></ul> <h4 id="callback" data-v-eeb3f718><a href="#callback" class="header-anchor" data-v-eeb3f718>#</a> Callback</h4> <p data-v-eeb3f718>callback 能接收到兩個參數</p> <div class="language-js extra-class" data-v-eeb3f718><pre class="language-js" data-v-eeb3f718><code data-v-eeb3f718><span class="token keyword" data-v-eeb3f718>function</span> <span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entries<span class="token punctuation" data-v-eeb3f718>,</span> observer</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  entries<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entry</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>if</span> <span class="token punctuation" data-v-eeb3f718>(</span>entry<span class="token punctuation" data-v-eeb3f718>.</span>isIntersecting<span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token operator" data-v-eeb3f718>...</span>
    <span class="token punctuation" data-v-eeb3f718>}</span> <span class="token keyword" data-v-eeb3f718>else</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token operator" data-v-eeb3f718>...</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span>
<span class="token punctuation" data-v-eeb3f718>}</span>
</code></pre></div><ul data-v-eeb3f718><li data-v-eeb3f718>entries<br data-v-eeb3f718>
因為可以同時觀察多個目標，所以會是一個 IntersectionObserverEntry 的 Array
<ul data-v-eeb3f718><li data-v-eeb3f718>boundingClientRect: DOMRectReadOnly</li> <li data-v-eeb3f718>rootBounds: DOMRectReadOnly</li> <li data-v-eeb3f718>intersectionRect: DOMRectReadOnly</li> <li data-v-eeb3f718>intersectionRatio: 觸發的比例值</li> <li data-v-eeb3f718>time: 觸發的時間戳</li> <li data-v-eeb3f718><code data-v-eeb3f718>target</code>: 觸發的目標元素</li> <li data-v-eeb3f718><code data-v-eeb3f718>isIntersecting</code>: 目標是否進入 (true) 或 離開 (false) 根層</li></ul></li></ul> <h3 id="觀察目標元素" data-v-eeb3f718><a href="#觀察目標元素" class="header-anchor" data-v-eeb3f718>#</a> 觀察目標元素</h3> <div class="language-js extra-class" data-v-eeb3f718><pre class="language-js" data-v-eeb3f718><code data-v-eeb3f718><span class="token comment" data-v-eeb3f718>// 開始觀察</span>
observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>observe</span><span class="token punctuation" data-v-eeb3f718>(</span>document<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>querySelector</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>'.js-target'</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>)</span>
</code></pre></div><h3 id="其他" data-v-eeb3f718><a href="#其他" class="header-anchor" data-v-eeb3f718>#</a> 其他</h3> <div class="language-js extra-class" data-v-eeb3f718><pre class="language-js" data-v-eeb3f718><code data-v-eeb3f718><span class="token comment" data-v-eeb3f718>// 停止觀察</span>
observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>disconnect</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span>

<span class="token comment" data-v-eeb3f718>// 停止觀察特定目標</span>
observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>unobserve</span><span class="token punctuation" data-v-eeb3f718>(</span>document<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>querySelector</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>'.js-target'</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>)</span>
</code></pre></div><h2 id="範例" data-v-eeb3f718><a href="#範例" class="header-anchor" data-v-eeb3f718>#</a> 範例</h2> <h3 id="lazy-loading-圖片" data-v-eeb3f718><a href="#lazy-loading-圖片" class="header-anchor" data-v-eeb3f718>#</a> Lazy Loading 圖片</h3> <img data-src="https://picsum.photos/64" class="block w-32 h-32 bg-gray-400 js-lazyload mt-2" data-v-eeb3f718> <img data-src="https://picsum.photos/128" class="block w-64 h-64 bg-gray-400 js-lazyload" data-v-eeb3f718> <img data-src="https://picsum.photos/256" class="block w-80 h-80 bg-gray-400 js-lazyload" data-v-eeb3f718> <div class="language-html extra-class" data-v-eeb3f718><pre class="language-html" data-v-eeb3f718><code data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>img</span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>... js-lazyload<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>data-src</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>https://picsum.photos/128<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token punctuation" data-v-eeb3f718>/&gt;</span></span>
</code></pre></div><div class="language-js extra-class" data-v-eeb3f718><pre class="language-js" data-v-eeb3f718><code data-v-eeb3f718><span class="token keyword" data-v-eeb3f718>const</span> observer <span class="token operator" data-v-eeb3f718>=</span> <span class="token keyword" data-v-eeb3f718>new</span> <span class="token class-name" data-v-eeb3f718>IntersectionObserver</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entries</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  entries<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entry</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>if</span> <span class="token punctuation" data-v-eeb3f718>(</span>entry<span class="token punctuation" data-v-eeb3f718>.</span>isIntersecting<span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token keyword" data-v-eeb3f718>const</span> img <span class="token operator" data-v-eeb3f718>=</span> entry<span class="token punctuation" data-v-eeb3f718>.</span>target<span class="token punctuation" data-v-eeb3f718>;</span>
      img<span class="token punctuation" data-v-eeb3f718>.</span>src <span class="token operator" data-v-eeb3f718>=</span> img<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>getAttribute</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>'data-src'</span><span class="token punctuation" data-v-eeb3f718>)</span>
      observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>unobserve</span><span class="token punctuation" data-v-eeb3f718>(</span>img<span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span>
<span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span><span class="token punctuation" data-v-eeb3f718>{</span> <span class="token literal-property property" data-v-eeb3f718>threshold</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token number" data-v-eeb3f718>1</span> <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>

document<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>querySelectorAll</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>'.js-lazyload'</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>el</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>observe</span><span class="token punctuation" data-v-eeb3f718>(</span>el<span class="token punctuation" data-v-eeb3f718>)</span>
<span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>
</code></pre></div><h3 id="infinite-scroll-無限加載內容" data-v-eeb3f718><a href="#infinite-scroll-無限加載內容" class="header-anchor" data-v-eeb3f718>#</a> Infinite Scroll 無限加載內容</h3> <div data-v-eeb3f718>內容數量 20</div> <div class="relative my-2 border-solid border h-64 overflow-y-auto overscroll-y-contain" data-v-eeb3f718><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>1</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>2</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>3</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>4</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>5</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>6</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>7</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>8</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>9</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>10</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>11</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>12</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>13</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>14</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>15</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>16</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>17</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>18</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>19</div><div class="border-solid border-t-0 border-l-0 border-r-0 border-b px-4 py-2" data-v-eeb3f718>20</div> <div class="text-center py-2" data-v-eeb3f718>・・・</div></div> <div class="language-vue extra-class" data-v-eeb3f718><pre class="language-vue" data-v-eeb3f718><code data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>template</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
  <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>ref</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>loadmore-wrap<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>... overflow-y-auto overscroll-y-contain<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>...<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>v-for</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>(num, index) in numList<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>:key</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>index<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>{{ index + 1 }}<span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>ref</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>loadmore<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>text-center py-2<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
      {{ isLoading ? '載入中...' : isMax ? '沒有更多了' : '・・・' }}
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
  <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
<span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>template</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>

<span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>script</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span><span class="token script" data-v-eeb3f718><span class="token language-javascript" data-v-eeb3f718>
<span class="token keyword" data-v-eeb3f718>export</span> <span class="token keyword" data-v-eeb3f718>default</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  <span class="token function" data-v-eeb3f718>data</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>return</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token literal-property property" data-v-eeb3f718>isLoading</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token boolean" data-v-eeb3f718>false</span><span class="token punctuation" data-v-eeb3f718>,</span>
      <span class="token literal-property property" data-v-eeb3f718>numList</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token function" data-v-eeb3f718>Array</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token number" data-v-eeb3f718>20</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>fill</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>''</span><span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token literal-property property" data-v-eeb3f718>computed</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token function" data-v-eeb3f718>isMax</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token keyword" data-v-eeb3f718>return</span> <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>numList<span class="token punctuation" data-v-eeb3f718>.</span>length <span class="token operator" data-v-eeb3f718>&gt;=</span> <span class="token number" data-v-eeb3f718>200</span><span class="token punctuation" data-v-eeb3f718>;</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token function" data-v-eeb3f718>mounted</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>const</span> observer <span class="token operator" data-v-eeb3f718>=</span> <span class="token keyword" data-v-eeb3f718>new</span> <span class="token class-name" data-v-eeb3f718>IntersectionObserver</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entries</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      entries<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entry</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
        <span class="token keyword" data-v-eeb3f718>if</span> <span class="token punctuation" data-v-eeb3f718>(</span>entry<span class="token punctuation" data-v-eeb3f718>.</span>isIntersecting<span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
          <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>loadMore</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>
        <span class="token punctuation" data-v-eeb3f718>}</span>
      <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span><span class="token punctuation" data-v-eeb3f718>{</span> 
      <span class="token literal-property property" data-v-eeb3f718>root</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>$refs<span class="token punctuation" data-v-eeb3f718>[</span><span class="token string" data-v-eeb3f718>'loadmore-wrap'</span><span class="token punctuation" data-v-eeb3f718>]</span><span class="token punctuation" data-v-eeb3f718>,</span>
      <span class="token literal-property property" data-v-eeb3f718>threshold</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token number" data-v-eeb3f718>0.3</span> 
    <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>

    observer<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>observe</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>$refs<span class="token punctuation" data-v-eeb3f718>.</span>loadmore<span class="token punctuation" data-v-eeb3f718>)</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token literal-property property" data-v-eeb3f718>methods</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token function" data-v-eeb3f718>loadMore</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token keyword" data-v-eeb3f718>if</span> <span class="token punctuation" data-v-eeb3f718>(</span><span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>isMax<span class="token punctuation" data-v-eeb3f718>)</span> <span class="token keyword" data-v-eeb3f718>return</span><span class="token punctuation" data-v-eeb3f718>;</span>

      <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>isLoading <span class="token operator" data-v-eeb3f718>=</span> <span class="token boolean" data-v-eeb3f718>true</span><span class="token punctuation" data-v-eeb3f718>;</span>
      <span class="token function" data-v-eeb3f718>setTimeout</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
        <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>isLoading <span class="token operator" data-v-eeb3f718>=</span> <span class="token boolean" data-v-eeb3f718>false</span><span class="token punctuation" data-v-eeb3f718>;</span>
        <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>numList<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>push</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token operator" data-v-eeb3f718>...</span><span class="token function" data-v-eeb3f718>Array</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token number" data-v-eeb3f718>20</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>fill</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>''</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>)</span>
      <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span> <span class="token number" data-v-eeb3f718>1000</span><span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span>
<span class="token punctuation" data-v-eeb3f718>}</span>
</span></span><span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>script</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
</code></pre></div><h3 id="scroll-spy-滾動監控" data-v-eeb3f718><a href="#scroll-spy-滾動監控" class="header-anchor" data-v-eeb3f718>#</a> Scroll Spy 滾動監控</h3> <div data-v-eeb3f718>Active Number: 1</div> <div class="relative my-2 border-solid border flex h-72 overflow-y-auto overscroll-y-contain" data-v-eeb3f718><div class="sticky top-0 w-1/2" data-v-eeb3f718><div class="block px-4 py-1 text-lg text-red-400 text-3xl" data-v-eeb3f718>1</div><div class="block px-4 py-1 text-lg" data-v-eeb3f718>2</div><div class="block px-4 py-1 text-lg" data-v-eeb3f718>3</div><div class="block px-4 py-1 text-lg" data-v-eeb3f718>4</div><div class="block px-4 py-1 text-lg" data-v-eeb3f718>5</div></div> <div class="w-1/2" data-v-eeb3f718><div data-num="1" class="h-72 text-center flex items-center justify-center font-bold text-5xl text-black bg-green-100" data-v-eeb3f718>
      1
    </div><div data-num="2" class="h-72 text-center flex items-center justify-center font-bold text-5xl text-black bg-green-200" data-v-eeb3f718>
      2
    </div><div data-num="3" class="h-72 text-center flex items-center justify-center font-bold text-5xl text-black bg-green-300" data-v-eeb3f718>
      3
    </div><div data-num="4" class="h-72 text-center flex items-center justify-center font-bold text-5xl text-black bg-green-400" data-v-eeb3f718>
      4
    </div><div data-num="5" class="h-72 text-center flex items-center justify-center font-bold text-5xl text-black bg-green-500" data-v-eeb3f718>
      5
    </div></div></div> <div class="language-vue extra-class" data-v-eeb3f718><pre class="language-vue" data-v-eeb3f718><code data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>template</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
  <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>ref</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>scrollspy-wrap<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>relative ... overflow-y-auto overscroll-y-contain<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>sticky top-0 w-1/2<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
      <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>v-for</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>j in 5<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>:key</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>j<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>...<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>:class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>{ 'text-red-400 text-3xl': activeNum === j }<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
        {{ j }}
      <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>w-1/2<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
      <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>div</span> <span class="token attr-name" data-v-eeb3f718>:ref</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>`spy${n}`<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>:data-num</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>n<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>class</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>...<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>v-for</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>n in 5<span class="token punctuation" data-v-eeb3f718>&quot;</span></span> 
        <span class="token attr-name" data-v-eeb3f718>:key</span><span class="token attr-value" data-v-eeb3f718><span class="token punctuation attr-equals" data-v-eeb3f718>=</span><span class="token punctuation" data-v-eeb3f718>&quot;</span>n<span class="token punctuation" data-v-eeb3f718>&quot;</span></span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
        {{ n }}
      <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
    <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
  <span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>div</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
<span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>template</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>

<span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;</span>script</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span><span class="token script" data-v-eeb3f718><span class="token language-javascript" data-v-eeb3f718>
<span class="token keyword" data-v-eeb3f718>export</span> <span class="token keyword" data-v-eeb3f718>default</span> <span class="token punctuation" data-v-eeb3f718>{</span>
  <span class="token function" data-v-eeb3f718>data</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>return</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token literal-property property" data-v-eeb3f718>activeNum</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token number" data-v-eeb3f718>1</span><span class="token punctuation" data-v-eeb3f718>,</span>
    <span class="token punctuation" data-v-eeb3f718>}</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span>
  <span class="token function" data-v-eeb3f718>mounted</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
    <span class="token keyword" data-v-eeb3f718>const</span> observer <span class="token operator" data-v-eeb3f718>=</span> <span class="token keyword" data-v-eeb3f718>new</span> <span class="token class-name" data-v-eeb3f718>IntersectionObserver</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entries</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      entries<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>entry</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
        <span class="token keyword" data-v-eeb3f718>if</span> <span class="token punctuation" data-v-eeb3f718>(</span>entry<span class="token punctuation" data-v-eeb3f718>.</span>isIntersecting<span class="token punctuation" data-v-eeb3f718>)</span> <span class="token punctuation" data-v-eeb3f718>{</span>
          <span class="token keyword" data-v-eeb3f718>const</span> num <span class="token operator" data-v-eeb3f718>=</span> entry<span class="token punctuation" data-v-eeb3f718>.</span>target<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>getAttribute</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>'data-num'</span><span class="token punctuation" data-v-eeb3f718>)</span>
          <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>activeNum <span class="token operator" data-v-eeb3f718>=</span> <span class="token operator" data-v-eeb3f718>+</span>num<span class="token punctuation" data-v-eeb3f718>;</span>
        <span class="token punctuation" data-v-eeb3f718>}</span>
      <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span><span class="token punctuation" data-v-eeb3f718>{</span> 
      <span class="token literal-property property" data-v-eeb3f718>root</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>$refs<span class="token punctuation" data-v-eeb3f718>[</span><span class="token string" data-v-eeb3f718>'scrollspy-wrap'</span><span class="token punctuation" data-v-eeb3f718>]</span><span class="token punctuation" data-v-eeb3f718>,</span>
      <span class="token literal-property property" data-v-eeb3f718>threshold</span><span class="token operator" data-v-eeb3f718>:</span> <span class="token number" data-v-eeb3f718>0.4</span>
    <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>;</span>

    <span class="token function" data-v-eeb3f718>Array</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token number" data-v-eeb3f718>5</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>fill</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token string" data-v-eeb3f718>''</span><span class="token punctuation" data-v-eeb3f718>)</span><span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>forEach</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token punctuation" data-v-eeb3f718>(</span><span class="token parameter" data-v-eeb3f718>_<span class="token punctuation" data-v-eeb3f718>,</span> i</span><span class="token punctuation" data-v-eeb3f718>)</span> <span class="token operator" data-v-eeb3f718>=&gt;</span> <span class="token punctuation" data-v-eeb3f718>{</span>
      <span class="token keyword" data-v-eeb3f718>const</span> temp <span class="token operator" data-v-eeb3f718>=</span> <span class="token keyword" data-v-eeb3f718>this</span><span class="token punctuation" data-v-eeb3f718>.</span>$refs<span class="token punctuation" data-v-eeb3f718>[</span><span class="token template-string" data-v-eeb3f718><span class="token template-punctuation string" data-v-eeb3f718>`</span><span class="token string" data-v-eeb3f718>spy</span><span class="token interpolation" data-v-eeb3f718><span class="token interpolation-punctuation punctuation" data-v-eeb3f718>${</span>i <span class="token operator" data-v-eeb3f718>+</span> <span class="token number" data-v-eeb3f718>1</span><span class="token interpolation-punctuation punctuation" data-v-eeb3f718>}</span></span><span class="token template-punctuation string" data-v-eeb3f718>`</span></span><span class="token punctuation" data-v-eeb3f718>]</span><span class="token punctuation" data-v-eeb3f718>;</span>
      observer3<span class="token punctuation" data-v-eeb3f718>.</span><span class="token function" data-v-eeb3f718>observe</span><span class="token punctuation" data-v-eeb3f718>(</span>temp<span class="token operator" data-v-eeb3f718>?.</span><span class="token punctuation" data-v-eeb3f718>[</span><span class="token number" data-v-eeb3f718>0</span><span class="token punctuation" data-v-eeb3f718>]</span> <span class="token operator" data-v-eeb3f718>??</span> temp<span class="token punctuation" data-v-eeb3f718>)</span>
    <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>)</span>
  <span class="token punctuation" data-v-eeb3f718>}</span><span class="token punctuation" data-v-eeb3f718>,</span>
<span class="token punctuation" data-v-eeb3f718>}</span>
</span></span><span class="token tag" data-v-eeb3f718><span class="token tag" data-v-eeb3f718><span class="token punctuation" data-v-eeb3f718>&lt;/</span>script</span><span class="token punctuation" data-v-eeb3f718>&gt;</span></span>
</code></pre></div></div> <div class="text-center text-xs text-gray-600 dark:text-gray-300 my-6"><!----> <div><span class="font-bold mr-1">Last Updated:</span> <span>2022/10/24 21:24:31</span></div></div> <footer><!----> <hr> <div><script src="https://utteranc.es/client.js" type="text/javascript" async="async" label="Utterances" issue-term="title" theme="" repo="clipwww/blog" crossorigin="anonymous"></script></div></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#intersection-observer-api" title="Intersection Observer API">Intersection Observer API</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#使用" title="使用">使用</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#建立一個-observer-觀察者" title="建立一個 observer 觀察者">建立一個 observer 觀察者</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#觀察目標元素" title="觀察目標元素">觀察目標元素</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#其他" title="其他">其他</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#範例" title="範例">範例</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#lazy-loading-圖片" title="Lazy Loading 圖片">Lazy Loading 圖片</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#infinite-scroll-無限加載內容" title="Infinite Scroll 無限加載內容">Infinite Scroll 無限加載內容</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#scroll-spy-滾動監控" title="Scroll Spy 滾動監控">Scroll Spy 滾動監控</a></div></div></div></div> <footer class="footer" data-v-51e6ef7f><div class="footer-left-wrap" data-v-51e6ef7f><ul class="contact" data-v-51e6ef7f><li class="contact-item" data-v-51e6ef7f><a href="https://github.com/clipwww" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-51e6ef7f><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-51e6ef7f><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-51e6ef7f></path></svg>
          
        </a></li><li class="contact-item" data-v-51e6ef7f><a href="https://www.linkedin.com/in/davidjian/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-51e6ef7f><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin" data-v-51e6ef7f><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" data-v-51e6ef7f></path><rect x="2" y="9" width="4" height="12" data-v-51e6ef7f></rect><circle cx="4" cy="4" r="2" data-v-51e6ef7f></circle></svg>
          
        </a></li><li class="contact-item" data-v-51e6ef7f><a href="mailto:clipwww@gmail.com" class="nav-link external" data-v-51e6ef7f><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-51e6ef7f><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-51e6ef7f></path><polyline points="22,6 12,13 2,6" data-v-51e6ef7f></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-51e6ef7f><ul class="copyright" data-v-51e6ef7f><li class="copyright-item" data-v-51e6ef7f><a href="/blog/" class="nav-link" data-v-51e6ef7f>Copyright © 2021 David,Jian</a></li><li class="copyright-item" data-v-51e6ef7f><a href="https://v1.vuepress.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-51e6ef7f>Powered by VuePress</a></li></ul></div></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/app.eb5ff63d.js" defer></script><script src="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/9.da230e77.js" defer></script><script src="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/2.5ed50062.js" defer></script><script src="https://cdn.jsdelivr.net/gh/clipwww/blog@gh-pages/assets/js/24.f23d7b72.js" defer></script>
  </body>
</html>
